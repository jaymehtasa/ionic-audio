function ionAudioTrack(n,o,i){function t(n,o,i,t){t.hasOwnProgressBar=o.find("ion-audio-progress-bar").length>0}function e(t,e){var a=this,r=0,s=function(o,i){o&&o.url&&(o.progress=0,o.status=0,o.duration=-1,i&&void 0!==i.id&&(o.id=i.id),n&&n.add(o,u,null,c,l))},u=function(){t.track.status=0,t.track.progress=0},c=function(n){t.track.status=n},l=function(o,e){if(t.track.progress=o,i.feedTrackTime==t.track.progress&&(r++,r>15)){var a=n.getCurrentTimePosition();a&&(console.log("play"),n.customPlay(),r=0)}i.feedTrackTime=t.track.progress,i.trackingFeedId=i.feedId,t.track.duration=e,i.totalTrackDuration=e},d=function(){o.$broadcast("ionic-audio:trackChange",t.track)};this.seekTo=function(o){n.seekTo(o)},this.getTrack=function(){return t.track},this.start=function(){if(t.track&&t.track.url)return n.play(t.track.id),a.hasOwnProgressBar||d(),t.track.id};var g=t.$watch("track",function(o,i){void 0!==o&&(n.stop(),s(o,i))});t.$on("$destroy",function(){g(),n.destroy()})}return{transclude:!0,template:"<ng-transclude></ng-transclude>",restrict:"E",scope:{track:"=",togglePlayback:"="},require:"ionAudioTrack",link:t,controller:["$scope","$element",e]}}function ionAudioProgress(){return{restrict:"E",scope:{track:"="},template:"{{track.progress | time}}"}}function ionAudioProgressBar(n){function o(o,i,t){function e(){}var a,r=i.find("input");angular.isDefined(t.displayTime)||(i.find("ion-audio-progress").remove(),i.find("ion-audio-duration").remove()),angular.isDefined(t.displayInfo)||i.find("h2").remove(),angular.isUndefined(o.track)&&(o.track={},a=o.$on("ionic-audio:trackChange",function(n,i){o.track=i}));var s=o.$watch("track.status",function(n){r.prop("disabled",0==n)});o.displayTrackInfo=function(){return{visibility:angular.isDefined(t.displayInfo)&&angular.isDefined(o.track)&&(o.track.title||o.track.artist)?"visible":"hidden"}},o.sliderRelease=function(){var i=o.track.progress;n.seekTo(i)},o.$on("$destroy",function(){s(),angular.isDefined(a)&&a()}),e()}return{restrict:"E",scope:{track:"=?"},template:'<h2 class="ion-audio-track-info" ng-style="displayTrackInfo()">{{track.title}} - {{track.artist}}</h2><div class="range range-assertive"><ion-audio-progress track="track"></ion-audio-progress><input type="range" name="volume" min="0" max="{{track.duration}}" ng-model="track.progress" on-release="sliderRelease()" disabled><ion-audio-duration track="track"></ion-audio-duration></div>',link:o}}function ionAudioPlay(n,o){function i(i,t,e,a){var r,s,u=0,c=function(){r=!1,t.addClass("ion-play"),t.removeClass("ion-pause"),t.text(e.textPlay)},l=function(){e.textPlay&&e.textPause&&t.text(t.text()==e.textPlay?e.textPause:e.textPlay)},d=function(){t.toggleClass("ion-play ion-pause"),l()};n.on("tap",function(){return s||r?void(s=!1):(0==u&&(r=!0),a.play(),void d())},t),n.on("doubletap",function(){s=!0},t);var g=i.$parent.$watch("track.status",function(n){0==n||4==n?c():2==n&&(r=!1),u=n}),f=i.$parent.$watch("togglePlayback",function(n,i){n!=i&&o(function(){d(),a.play()},300)});c(),i.$on("$destroy",function(){g(),f()})}return{restrict:"A",require:"^^ionAudioControls",link:i}}function ionAudioDuration(){return{restrict:"E",scope:{track:"="},template:"{{track.duration | duration}}"}}angular.module("ionic-audio",["ionic"]),angular.module("ionic-audio").filter("time",function(){var n=function(n){return(new Array(2).join("0")+n).slice(-2)};return function(o){o=o||0;var i=parseInt(o);return n(Math.floor(i/60))+":"+n(i%60)}}),angular.module("ionic-audio").filter("duration",["$filter",function(n){return function(o){return o>0?n("time")(o):""}}]),angular.module("ionic-audio").factory("MediaManager",["$interval","$timeout","$window","$rootScope","Player",function(n,o,i,t,e){function a(n){if(!(n.id<0)){var o=I.filter(function(o){return o.id==n.id}).pop();return o&&I.splice(o.id,1,n),o}}function r(){f()}function s(n,o,i,t,e){return console.log("135...",n),n.url?(angular.extend(n,{onSuccess:o,onError:i,onStatusChange:t,onProgress:e,status:0,duration:-1,progress:0}),$(n),a(n)?n.id:(n.id=I.push(n)-1,n.id)):void console.log("ionic-audio: missing track url")}function u(n){if(angular.isNumber(n)&&!(n>I.length-1)){if(C){if(C.id==n)return void(C.status==Media.MEDIA_RUNNING?c():f());C.id>-1&&p()}o(function(){g(I[n])},300)}}function c(){T.pause(),h(),t.customPlayEnable=!0,t.genericPlayEnable=!0}function l(n){T&&(T.seekTo(1e3*n),null!=e.setRate&&T.setRate(e.setRate))}function d(){h(),y()}function g(n){C=n,T=k(C),T.play(),M(),t.customPlayEnable=!1,t.genericPlayEnable=!1}function f(){T.play(),null!=e.setRate&&T.setRate(e.setRate),M(),t.customPlayEnable=!1,t.genericPlayEnable=!1}function p(){T&&(T.stop(),t.customPlayEnable=!0,t.genericPlayEnable=!0,MusicControls.destroy())}function k(n){if(n.url)return new Media(n.url,angular.bind(n,m),angular.bind(n,v),angular.bind(n,P))}function y(){angular.isDefined(T)&&(T.release(),T=void 0,C=void 0,t.customPlayEnable=!0,t.genericPlayEnable=!0,MusicControls.destroy())}function m(){h(),y(),angular.isFunction(this.onSuccess)&&this.onSuccess()}function v(){angular.isFunction(this.onError)&&this.onError()}function P(n){this.status=n,console.log("status is"+n),console.log("Media.MEDIA_RUNNING is "+Media.MEDIA_RUNNING),Media.MEDIA_RUNNING==n&&(console.log("inside status"),console.log(e.seekTo),e.seekTo&&(console.log("inside seekTo"),T.pause(),setTimeout(function(){T.seekTo(1e3*e.seekTo),T.play(),e.seekTo=null},3e3))),angular.isFunction(this.onStatusChange)&&this.onStatusChange(n)}function h(){angular.isDefined(E)&&(n.cancel(E),E=void 0)}function b(){return T}function M(){angular.isDefined(E)||C&&(E=n(function(){C.duration<0&&(C.duration=T.getDuration()),T.getCurrentPosition(function(n){n>-1&&(C.progress=n)},function(n){console.log("Error getting pos="+n)}),angular.isFunction(C.onProgress)&&(C.onProgress(C.progress,C.duration),console.log("274...",C.progress,C.duration),A(C.progress,C.duration))},1e3))}function A(n,o){MusicControls.update({duration:o,elapsed:n})}function $(n){function o(n){switch(console.log(140),console.log(n),n){case"music-controls-next":break;case"music-controls-previous":break;case"music-controls-pause":c(),MusicControls.updateIsPlaying(!1);break;case"music-controls-play":f(),MusicControls.updateIsPlaying(!0);break;case"music-controls-destroy":p();break;case"music-controls-toggle-play-pause":C.status==Media.MEDIA_RUNNING?(c(),MusicControls.updateIsPlaying(!1)):C.status==Media.MEDIA_PAUSED&&(f(),MusicControls.updateIsPlaying(!0));break;case"music-controls-media-button":break;case"music-controls-headset-unplugged":break;case"music-controls-headset-plugged":}}console.log("299....",JSON.stringify(n)),MusicControls.create({track:n.title,artist:n.album,cover:n.imageUrl,isPlaying:!0,dismissable:!0,hasPrev:!1,hasNext:!1,hasClose:!0,album:"",duration:n.duration,elapsed:0,ticker:'Now playing "'+n.title+'"'},function(n,o,i){console.log("a,b,c"),console.log(n,o,i)},function(n,o,i){console.log("Fa,b,c"),console.log(n,o,i)}),MusicControls.subscribe(o),MusicControls.listen()}var C,T,E,I=[];return i.cordova||i.Media?{add:s,play:u,pause:c,stop:p,seekTo:l,destroy:d,getCurrentTimePosition:b,customPlay:r}:(console.log("ionic-audio: missing Cordova Media plugin. Have you installed the plugin? \nRun 'ionic plugin add cordova-plugin-media'"),null)}]),angular.module("ionic-audio").directive("ionAudioTrack",["MediaManager","$rootScope","Player",ionAudioTrack]),angular.module("ionic-audio").directive("ionAudioProgress",ionAudioProgress),angular.module("ionic-audio").directive("ionAudioProgressBar",["MediaManager",ionAudioProgressBar]),angular.module("ionic-audio").directive("ionAudioPlay",["$ionicGesture","$timeout",ionAudioPlay]),angular.module("ionic-audio").directive("ionAudioDuration",ionAudioDuration),angular.module("ionic-audio").directive("ionAudioControls",function(){function n(n,o){var i,t=o.find("ion-spinner"),e=this;t.addClass("ng-hide"),this.toggleSpinner=function(){t.toggleClass("ng-hide")},this.play=function(){i||e.toggleSpinner(),this.start()};var a=n.$parent.$watch("track.status",function(n){switch(n){case 1:i=!1;break;case 2:i||(e.toggleSpinner(),i=!0);break;case 0:case 4:i=!1}});n.$on("$destroy",function(){a()})}function o(n,o,i,t){t[0].start=t[1].start}return{restrict:"EA",require:["ionAudioControls","^^ionAudioTrack"],controller:["$scope","$element",n],link:o}});