function ionAudioTrack(n,i,o){function t(n,i,o,t){t.hasOwnProgressBar=i.find("ion-audio-progress-bar").length>0}function e(t,e){var r=this,a=0,u=function(i,o){i&&i.url&&(i.progress=0,i.status=0,i.duration=-1,o&&void 0!==o.id&&(i.id=o.id),n&&n.add(i,s,null,c,l))},s=function(){t.track.status=0,t.track.progress=0},c=function(n){t.track.status=n},l=function(i,e){if(t.track.progress=i,o.feedTrackTime==t.track.progress&&(a++,a>15)){var r=n.getCurrentTimePosition();r&&(console.log("play"),n.customPlay(),a=0)}o.feedTrackTime=t.track.progress,o.trackingFeedId=o.feedId,t.track.duration=e,o.totalTrackDuration=e},d=function(){i.$broadcast("ionic-audio:trackChange",t.track)};this.seekTo=function(i){n.seekTo(i)},this.getTrack=function(){return t.track},this.start=function(){if(t.track&&t.track.url)return n.play(t.track.id),r.hasOwnProgressBar||d(),t.track.id};var g=t.$watch("track",function(i,o){void 0!==i&&(n.stop(),u(i,o))});t.$on("$destroy",function(){g(),n.destroy()})}return{transclude:!0,template:"<ng-transclude></ng-transclude>",restrict:"E",scope:{track:"=",togglePlayback:"="},require:"ionAudioTrack",link:t,controller:["$scope","$element",e]}}function ionAudioProgress(){return{restrict:"E",scope:{track:"="},template:"{{track.progress | time}}"}}function ionAudioProgressBar(n){function i(i,o,t){function e(){}var r,a=o.find("input");angular.isDefined(t.displayTime)||(o.find("ion-audio-progress").remove(),o.find("ion-audio-duration").remove()),angular.isDefined(t.displayInfo)||o.find("h2").remove(),angular.isUndefined(i.track)&&(i.track={},r=i.$on("ionic-audio:trackChange",function(n,o){i.track=o}));var u=i.$watch("track.status",function(n){a.prop("disabled",0==n)});i.displayTrackInfo=function(){return{visibility:angular.isDefined(t.displayInfo)&&angular.isDefined(i.track)&&(i.track.title||i.track.artist)?"visible":"hidden"}},i.sliderRelease=function(){var o=i.track.progress;n.seekTo(o)},i.$on("$destroy",function(){u(),angular.isDefined(r)&&r()}),e()}return{restrict:"E",scope:{track:"=?"},template:'<h2 class="ion-audio-track-info" ng-style="displayTrackInfo()">{{track.title}} - {{track.artist}}</h2><div class="range range-assertive"><ion-audio-progress track="track"></ion-audio-progress><input type="range" name="volume" min="0" max="{{track.duration}}" ng-model="track.progress" on-release="sliderRelease()" disabled><ion-audio-duration track="track"></ion-audio-duration></div>',link:i}}function ionAudioPlay(n,i){function o(o,t,e,r){var a,u,s=0,c=function(){a=!1,t.addClass("ion-play"),t.removeClass("ion-pause"),t.text(e.textPlay)},l=function(){e.textPlay&&e.textPause&&t.text(t.text()==e.textPlay?e.textPause:e.textPlay)},d=function(){t.toggleClass("ion-play ion-pause"),l()};n.on("tap",function(){return u||a?void(u=!1):(0==s&&(a=!0),r.play(),void d())},t),n.on("doubletap",function(){u=!0},t);var g=o.$parent.$watch("track.status",function(n){0==n||4==n?c():2==n&&(a=!1),s=n}),f=o.$parent.$watch("togglePlayback",function(n,o){n!=o&&i(function(){d(),r.play()},300)});c(),o.$on("$destroy",function(){g(),f()})}return{restrict:"A",require:"^^ionAudioControls",link:o}}function ionAudioDuration(){return{restrict:"E",scope:{track:"="},template:"{{track.duration | duration}}"}}angular.module("ionic-audio",["ionic"]),angular.module("ionic-audio").filter("time",function(){var n=function(n){return(new Array(2).join("0")+n).slice(-2)};return function(i){i=i||0;var o=parseInt(i);return n(Math.floor(o/60))+":"+n(o%60)}}),angular.module("ionic-audio").filter("duration",["$filter",function(n){return function(i){return i>0?n("time")(i):""}}]),angular.module("ionic-audio").factory("MediaManager",["$interval","$timeout","$window","$rootScope","Player",function(n,i,o,t,e){function r(n){if(!(n.id<0)){var i=M.filter(function(i){return i.id==n.id}).pop();return i&&M.splice(i.id,1,n),i}}function a(){f()}function u(n,i,o,t,e){return n.url?(angular.extend(n,{onSuccess:i,onError:o,onStatusChange:t,onProgress:e,status:0,duration:-1,progress:0}),r(n)?n.id:(n.id=M.push(n)-1,n.id)):void console.log("ionic-audio: missing track url")}function s(n){if(angular.isNumber(n)&&!(n>M.length-1)){if(A){if(A.id==n)return void(A.status==Media.MEDIA_RUNNING?c():f());A.id>-1&&p()}i(function(){g(M[n])},300)}}function c(){b.pause(),P(),t.customPlayEnable=!0,t.genericPlayEnable=!0}function l(n){b&&b.seekTo(1e3*n)}function d(){P(),y()}function g(n){A=n,b=k(A),b.play(),T(),t.customPlayEnable=!1,t.genericPlayEnable=!1}function f(){b.play(),T(),t.customPlayEnable=!1,t.genericPlayEnable=!1}function p(){b&&(b.stop(),t.customPlayEnable=!0,t.genericPlayEnable=!0)}function k(n){if(n.url)return new Media(n.url,angular.bind(n,m),angular.bind(n,v),angular.bind(n,h))}function y(){angular.isDefined(b)&&(b.release(),b=void 0,A=void 0,t.customPlayEnable=!0,t.genericPlayEnable=!0)}function m(){P(),y(),angular.isFunction(this.onSuccess)&&this.onSuccess()}function v(){angular.isFunction(this.onError)&&this.onError()}function h(n){this.status=n,console.log("status is"+n),console.log("Media.MEDIA_RUNNING is"+Media.MEDIA_RUNNING),Media.MEDIA_RUNNING==n&&(console.log("inside status"),console.log(e.seekTo),e.seekTo&&(console.log("inside seekTo"),b.pause(),setTimeout(function(){b.seekTo(1e3*e.seekTo),b.play(),e.seekTo=null},3e3))),angular.isFunction(this.onStatusChange)&&this.onStatusChange(n)}function P(){angular.isDefined(E)&&(n.cancel(E),E=void 0)}function $(){return b}function T(){angular.isDefined(E)||A&&(E=n(function(){A.duration<0&&(A.duration=b.getDuration()),b.getCurrentPosition(function(n){n>-1&&(A.progress=n)},function(n){console.log("Error getting pos="+n)}),angular.isFunction(A.onProgress)&&A.onProgress(A.progress,A.duration)},1e3))}var A,b,E,M=[];return o.cordova||o.Media?{add:u,play:s,pause:c,stop:p,seekTo:l,destroy:d,getCurrentTimePosition:$,customPlay:a}:(console.log("ionic-audio: missing Cordova Media plugin. Have you installed the plugin? \nRun 'ionic plugin add cordova-plugin-media'"),null)}]),angular.module("ionic-audio").directive("ionAudioTrack",["MediaManager","$rootScope","Player",ionAudioTrack]),angular.module("ionic-audio").directive("ionAudioProgress",ionAudioProgress),angular.module("ionic-audio").directive("ionAudioProgressBar",["MediaManager",ionAudioProgressBar]),angular.module("ionic-audio").directive("ionAudioPlay",["$ionicGesture","$timeout",ionAudioPlay]),angular.module("ionic-audio").directive("ionAudioDuration",ionAudioDuration),angular.module("ionic-audio").directive("ionAudioControls",function(){function n(n,i){var o,t=i.find("ion-spinner"),e=this;t.addClass("ng-hide"),this.toggleSpinner=function(){t.toggleClass("ng-hide")},this.play=function(){o||e.toggleSpinner(),this.start()};var r=n.$parent.$watch("track.status",function(n){switch(n){case 1:o=!1;break;case 2:o||(e.toggleSpinner(),o=!0);break;case 0:case 4:o=!1}});n.$on("$destroy",function(){r()})}function i(n,i,o,t){t[0].start=t[1].start}return{restrict:"EA",require:["ionAudioControls","^^ionAudioTrack"],controller:["$scope","$element",n],link:i}});